<!DOCTYPE html><html lang="en-US"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try {var d=document.documentElement.classList;d.remove('light','dark');var e=localStorage.getItem('theme');if(!e)return localStorage.setItem('theme','system'),d.add('system');if("system"===e){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?d.add('dark'):d.add('light')}else d.add(e)}catch(e){}}()</script><title>How to build a credit risk model</title><meta name="description" content="A data scientists guide to building a basic credit risk model"/><meta property="og:type" content="website"/><meta name="og:title" property="og:title" content="How to build a credit risk model"/><meta name="og:description" property="og:description" content="A data scientists guide to building a basic credit risk model"/><meta name="twitter:card" content="summary"/><meta name="twitter:title" content="How to build a credit risk model"/><meta name="twitter:description" content="A data scientists guide to building a basic credit risk model"/><meta name="twitter:creator" content="franciscojarceo"/><link rel="icon" type="image/png" href="/favicon.ico"/><link rel="apple-touch-icon" href="/favicon.ico"/><meta name="next-head-count" content="14"/><link rel="preload" href="/_next/static/css/0396dc5eacf9c1593f16.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0396dc5eacf9c1593f16.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-39418da170c6bb422e22.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.a6f6c255f30e2cc8ab2c.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-e96c85129056fdc0f68b.js" as="script"/><link rel="preload" href="/_next/static/chunks/5e7de4f36e438e169c5d145e7df90137ae956f1e.7d3641e730cc6fd301c7.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/post/%5Bslug%5D-30c90bc3b4b0bd4e7214.js" as="script"/></head><body><div id="__next"><div class="w-full min-h-screen dark:bg-gray-700 dark:text-white"><div class="max-w-screen-md px-4 py-12 mx-auto antialiased font-body"><header class="flex items-center justify-between  mb-2"><meta name="description" content="My chaotic thoughts on computers, statistics, finance, and data"/><meta name="keywords" content="francisco javier arceo, data science, finance, fintech, engineering, django, python"/><meta property="og:type" content="website"/><meta property="og:title" content="Francisco&#x27;s Random Thoughts"/><meta property="og:locale" content="en_US"/><meta property="og:description" content="My chaotic thoughts on computers, statistics, finance, and data"/><meta property="og:image" content="https://og-image.now.sh/Francisco&#x27;s%20Random%20Thoughts.png?theme=light&amp;md=0&amp;fontSize=75px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><meta name="twitter:description" content="My chaotic thoughts on computers, statistics, finance, and data"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="franciscojarceo"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-71125809-1/"></script><script src="/ga.js"></script><div class="max-w-md"><h1><a class="text-2xl font-black text-black no-underline font-display dark:text-white" href="/">Francisco Javier Arceo</a></h1></div><script></script></header><main style="padding-bottom:10px"><article><header class="mb-8"><h1 class="mb-2 text-6xl font-black leading-none font-display">How to build a credit risk model</h1><p class="text-sm">January 27, 2021</p></header><div class="mb-4 prose lg:prose-lg dark:prose-dark"><p><em>TL;DR: A Data Science Tutorial on building a Credit Risk model</em></p><p>I previously <a href="/post/data-science-and-fintech">wrote</a> about some of the work data scientists do in the fintech space, which briefly discussed <a href="https://en.wikipedia.org/wiki/Credit_risk">credit risk models</a> but I wanted to write a more technical review and talk about what I think are the most important points.</p><p>I spent most of my career at banks as a data scientist and built credit risk models in the consumer and commercial space in the US, Australia, and South Africa. I learned a lot from those experiences, so I thought I&#x27;d share a simple example of how one of the core pieces of algorithmic/quantitative underwriting is done.</p><p>In this post, I&#x27;ll try to answer the following questions:</p><ul><li>What is a credit risk model?</li><li>What <strong>data</strong> does a credit risk model use?</li><li>How do you estimate a credit risk model?</li><li>How do you know if your model is performing well?</li><li>What are some common mistakes to avoid?</li><li>What are useful facts to know about credit risk models?</li></ul><h2>What is a Credit Risk Model?</h2><p>In the consumer/retail space, a credit risk model tries to predict the probability that a consumer won&#x27;t repay money that they&#x27;ve borrowed.
A simple example of this is an <a href="https://www.investopedia.com/terms/u/unsecuredloan.asp">unsecured personal loan</a>.
Let&#x27;s suppose you submitted an application to borrow $5,000 from a lender. That lender would want to know the likelihood of <a href="https://www.investopedia.com/terms/d/default2.asp">default</a> before deciding on (1) whether to give you the loan and (2) the price they want to charge you to for borrowing the money. So that probability is probably quite important...but how do they come up with it?</p><h2>What Data does a Credit Risk model use?</h2><p>Lenders typically use data from the major <a href="https://www.investopedia.com/personal-finance/top-three-credit-bureaus/">Credit Bureaus</a> that is <a href="https://www.ftc.gov/enforcement/statutes/fair-credit-reporting-act">FCRA</a> compliant, which basically means that the legal and reputational risk of using this data is very low.</p><p>Typically, you&#x27;d purchase a dataset from one of the bureaus (or use data inside one of their analytical sandboxes) and clean the dataset into something that looks like the following:</p><table>
  <tr>
    <th>Default</th>
    <th>Inquiries in Last 6 Months</th>
    <th>Credit Utilization</th>
    <th>Average Age of Credit</th>
    <th>...</th>
  </tr>
  <tr>
    <td>Yes</td>
    <td>2</td>
    <td>0.8</td>
    <td>12</td>
    <td>...</td>
  </tr>
  <tr>
    <td>No</td>
    <td>8</td>
    <td>0.0</td>
    <td>2</td>
    <td>...</td>
  </tr>
  <tr>
    <td>...</td>
    <td>...</td>
    <td>...</td>
    <td>...</td>
    <td>...</td>
  </tr>
</table><p>And so on.</p><p>In summary, it&#x27;s just a bunch of data about your borrowing history.
It&#x27;s a little recursive/cyclical because in order to grow your credit you need to have credit but let&#x27;s ignore that detail.</p><p>One of the most important steps in the model development process is <em>precisely</em> defining <strong>default</strong> because this will eventually reflect the performance of your portfolio, so defining it rigorously, accurately, and confidently is extremely consequential.</p><p>So how do you define it?</p><p>Time. If you&#x27;re planning to launch a term loan, you usually set boundaries on the duration of the loan.
Let&#x27;s say you want to launch a 12 month loan to an underserved market, then you&#x27;d want to get historical data of other lenders to build your model on.
It sounds a little surprising that you can do this but that&#x27;s basically how the bureaus make their money.
An important thing to keep in mind is that you need to make sure you pull the data at 2 different time periods: (1) when the original application was made and (2) 12 months later to check if the consumer defaulted on their loan.</p><p>There&#x27;s a lot more to it and you can expand on things in much more elegant ways to handle different phenomena but for the sake of simplicity, this is essentially how it&#x27;s done.</p><p>So, after painfully cleaning up all that data, what do you do with it?</p><h2>Building a Probability of Default Model</h2><p>Now that you have that glorious dataset you can start to run different <a href="https://en.wikipedia.org/wiki/Logistic_regression">Logistic Regressions</a> or use other machine learning algorithms to find hidden patterns and relationships (i.e., <a href="https://blog.minitab.com/blog/adventures-in-statistics-2/what-is-the-difference-between-linear-and-nonlinear-equations-in-regression-analysis#:~:text=If%20the%20equation%20doesn&#x27;t,a%20linear%20equation%2C%20it&#x27;s%20nonlinear.&amp;text=Thetas%20represent%20the%20parameters%20and,one%20parameter%20per%20predictor%20variable.">non-linear functions</a> and <a href="https://en.wikipedia.org/wiki/Interaction_(statistics)">interaction terms</a>).
Personally, this is the most intellectually engaging part of the work. The other work involved in credit risk modeling is usually very stressful and filled with less exciting graphs but here you get to pause, look at data, and, for a moment, try to make a crude approximation of the world. I find this part <em>fascinating</em>.</p><p>If we stick with our simple model above, we could use our good old friend Python to run a simple regression.</p><pre style="color:#f8f8f2;background:#282a36;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;border-radius:0.3em"><code class="language-python" style="color:#f8f8f2;background:none;text-shadow:0 1px rgba(0, 0, 0, 0.3);font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">1</span><span class="token" style="color:#8be9fd">import</span><span> numpy </span><span class="token" style="color:#8be9fd">as</span><span> np
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">2</span><span></span><span class="token" style="color:#8be9fd">import</span><span> pandas </span><span class="token" style="color:#8be9fd">as</span><span> pd
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">3</span><span></span><span class="token" style="color:#8be9fd">import</span><span> statsmodels</span><span class="token" style="color:#f8f8f2">.</span><span>api </span><span class="token" style="color:#8be9fd">as</span><span> sm
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">4</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">5</span><span>n </span><span class="token" style="color:#f8f8f2">=</span><span> </span><span class="token" style="color:#bd93f9">10000</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">6</span><span>np</span><span class="token" style="color:#f8f8f2">.</span><span>random</span><span class="token" style="color:#f8f8f2">.</span><span>seed</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#bd93f9">0</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">7</span><span>x_1 </span><span class="token" style="color:#f8f8f2">=</span><span> np</span><span class="token" style="color:#f8f8f2">.</span><span>random</span><span class="token" style="color:#f8f8f2">.</span><span>poisson</span><span class="token" style="color:#f8f8f2">(</span><span>lam</span><span class="token" style="color:#f8f8f2">=</span><span class="token" style="color:#bd93f9">5</span><span class="token" style="color:#f8f8f2">,</span><span> size</span><span class="token" style="color:#f8f8f2">=</span><span>n</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">8</span><span>x_2 </span><span class="token" style="color:#f8f8f2">=</span><span> np</span><span class="token" style="color:#f8f8f2">.</span><span>random</span><span class="token" style="color:#f8f8f2">.</span><span>poisson</span><span class="token" style="color:#f8f8f2">(</span><span>lam</span><span class="token" style="color:#f8f8f2">=</span><span class="token" style="color:#bd93f9">2</span><span class="token" style="color:#f8f8f2">,</span><span> size</span><span class="token" style="color:#f8f8f2">=</span><span>n</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">9</span><span>x_3 </span><span class="token" style="color:#f8f8f2">=</span><span> np</span><span class="token" style="color:#f8f8f2">.</span><span>random</span><span class="token" style="color:#f8f8f2">.</span><span>poisson</span><span class="token" style="color:#f8f8f2">(</span><span>lam</span><span class="token" style="color:#f8f8f2">=</span><span class="token" style="color:#bd93f9">12</span><span class="token" style="color:#f8f8f2">,</span><span> size</span><span class="token" style="color:#f8f8f2">=</span><span>n</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">10</span><span>e </span><span class="token" style="color:#f8f8f2">=</span><span> np</span><span class="token" style="color:#f8f8f2">.</span><span>random</span><span class="token" style="color:#f8f8f2">.</span><span>normal</span><span class="token" style="color:#f8f8f2">(</span><span>size</span><span class="token" style="color:#f8f8f2">=</span><span>n</span><span class="token" style="color:#f8f8f2">,</span><span> loc</span><span class="token" style="color:#f8f8f2">=</span><span class="token" style="color:#bd93f9">0</span><span class="token" style="color:#f8f8f2">,</span><span> scale</span><span class="token" style="color:#f8f8f2">=</span><span class="token" style="color:#bd93f9">1</span><span class="token" style="color:#f8f8f2">.</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">11</span>
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">12</span><span>b_1</span><span class="token" style="color:#f8f8f2">,</span><span> b_2</span><span class="token" style="color:#f8f8f2">,</span><span> b_3 </span><span class="token" style="color:#f8f8f2">=</span><span> </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.005</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.03</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.15</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">13</span><span>ylogpred </span><span class="token" style="color:#f8f8f2">=</span><span>  x_1 </span><span class="token" style="color:#f8f8f2">*</span><span> b_1 </span><span class="token" style="color:#f8f8f2">+</span><span> x_2 </span><span class="token" style="color:#f8f8f2">*</span><span> b_2 </span><span class="token" style="color:#f8f8f2">+</span><span> x_3 </span><span class="token" style="color:#f8f8f2">*</span><span> b_3 </span><span class="token" style="color:#f8f8f2">+</span><span> e
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">14</span><span>yprob </span><span class="token" style="color:#f8f8f2">=</span><span> </span><span class="token" style="color:#bd93f9">1</span><span class="token" style="color:#f8f8f2">.</span><span class="token" style="color:#f8f8f2">/</span><span> </span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#bd93f9">1</span><span class="token" style="color:#f8f8f2">.</span><span class="token" style="color:#f8f8f2">+</span><span> np</span><span class="token" style="color:#f8f8f2">.</span><span>exp</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f8f8f2">-</span><span>ylogpred</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">15</span><span>yclass </span><span class="token" style="color:#f8f8f2">=</span><span> np</span><span class="token" style="color:#f8f8f2">.</span><span>where</span><span class="token" style="color:#f8f8f2">(</span><span>yprob </span><span class="token" style="color:#f8f8f2">&gt;=</span><span> </span><span class="token" style="color:#bd93f9">0.5</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#bd93f9">1</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#bd93f9">0</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">16</span><span>xs </span><span class="token" style="color:#f8f8f2">=</span><span> np</span><span class="token" style="color:#f8f8f2">.</span><span>hstack</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f8f8f2">[</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">17</span><span>    x_1</span><span class="token" style="color:#f8f8f2">.</span><span>reshape</span><span class="token" style="color:#f8f8f2">(</span><span>n</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#bd93f9">1</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">,</span><span> 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">18</span><span>    x_2</span><span class="token" style="color:#f8f8f2">.</span><span>reshape</span><span class="token" style="color:#f8f8f2">(</span><span>n</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#bd93f9">1</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">,</span><span> 
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">19</span><span>    x_3</span><span class="token" style="color:#f8f8f2">.</span><span>reshape</span><span class="token" style="color:#f8f8f2">(</span><span>n</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#bd93f9">1</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">20</span><span></span><span class="token" style="color:#f8f8f2">]</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">21</span><span>xs </span><span class="token" style="color:#f8f8f2">=</span><span> sm</span><span class="token" style="color:#f8f8f2">.</span><span>add_constant</span><span class="token" style="color:#f8f8f2">(</span><span>xs</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">22</span><span>model </span><span class="token" style="color:#f8f8f2">=</span><span> sm</span><span class="token" style="color:#f8f8f2">.</span><span>Logit</span><span class="token" style="color:#f8f8f2">(</span><span>y</span><span class="token" style="color:#f8f8f2">,</span><span> x</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">23</span><span>res </span><span class="token" style="color:#f8f8f2">=</span><span> model</span><span class="token" style="color:#f8f8f2">.</span><span>fit</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">24</span><span></span><span class="token" style="color:#8be9fd">print</span><span class="token" style="color:#f8f8f2">(</span><span>res</span><span class="token" style="color:#f8f8f2">.</span><span>summary</span><span class="token" style="color:#f8f8f2">(</span><span class="token" style="color:#f8f8f2">)</span><span class="token" style="color:#f8f8f2">)</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">25</span><span>         Current function value</span><span class="token" style="color:#f8f8f2">:</span><span> </span><span class="token" style="color:#bd93f9">0.163863</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">26</span><span>         Iterations </span><span class="token" style="color:#bd93f9">8</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">27</span>                           Logit Regression Results                           
<span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">28</span><span></span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">29</span><span>Dep</span><span class="token" style="color:#f8f8f2">.</span><span> Variable</span><span class="token" style="color:#f8f8f2">:</span><span>                      y   No</span><span class="token" style="color:#f8f8f2">.</span><span> Observations</span><span class="token" style="color:#f8f8f2">:</span><span>                </span><span class="token" style="color:#bd93f9">10000</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">30</span><span>Model</span><span class="token" style="color:#f8f8f2">:</span><span>                          Logit   Df Residuals</span><span class="token" style="color:#f8f8f2">:</span><span>                     </span><span class="token" style="color:#bd93f9">9996</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">31</span><span>Method</span><span class="token" style="color:#f8f8f2">:</span><span>                           MLE   Df Model</span><span class="token" style="color:#f8f8f2">:</span><span>                            </span><span class="token" style="color:#bd93f9">3</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">32</span><span>Date</span><span class="token" style="color:#f8f8f2">:</span><span>                Fri</span><span class="token" style="color:#f8f8f2">,</span><span> </span><span class="token" style="color:#bd93f9">29</span><span> Jan </span><span class="token" style="color:#bd93f9">2021</span><span>   Pseudo R</span><span class="token" style="color:#f8f8f2">-</span><span>squ</span><span class="token" style="color:#f8f8f2">.</span><span class="token" style="color:#f8f8f2">:</span><span>                  </span><span class="token" style="color:#bd93f9">0.1056</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">33</span><span>Time</span><span class="token" style="color:#f8f8f2">:</span><span>                        </span><span class="token" style="color:#bd93f9">00</span><span class="token" style="color:#f8f8f2">:</span><span class="token" style="color:#bd93f9">08</span><span class="token" style="color:#f8f8f2">:</span><span class="token" style="color:#bd93f9">17</span><span>   Log</span><span class="token" style="color:#f8f8f2">-</span><span>Likelihood</span><span class="token" style="color:#f8f8f2">:</span><span>                </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">1638.6</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">34</span><span>converged</span><span class="token" style="color:#f8f8f2">:</span><span>                       </span><span class="token" style="color:#bd93f9">True</span><span>   LL</span><span class="token" style="color:#f8f8f2">-</span><span>Null</span><span class="token" style="color:#f8f8f2">:</span><span>                       </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">1832.2</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">35</span><span>Covariance Type</span><span class="token" style="color:#f8f8f2">:</span><span>            nonrobust   LLR p</span><span class="token" style="color:#f8f8f2">-</span><span>value</span><span class="token" style="color:#f8f8f2">:</span><span>                 </span><span class="token" style="color:#bd93f9">1.419e-83</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">36</span><span></span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">37</span><span>                 coef    std err          z      P</span><span class="token" style="color:#f8f8f2">&gt;</span><span class="token" style="color:#f8f8f2">|</span><span>z</span><span class="token" style="color:#f8f8f2">|</span><span>      </span><span class="token" style="color:#f8f8f2">[</span><span class="token" style="color:#bd93f9">0.025</span><span>      </span><span class="token" style="color:#bd93f9">0.975</span><span class="token" style="color:#f8f8f2">]</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">38</span><span></span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#f8f8f2">-</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">39</span><span>const          </span><span class="token" style="color:#bd93f9">0.4535</span><span>      </span><span class="token" style="color:#bd93f9">0.209</span><span>      </span><span class="token" style="color:#bd93f9">2.166</span><span>      </span><span class="token" style="color:#bd93f9">0.030</span><span>       </span><span class="token" style="color:#bd93f9">0.043</span><span>       </span><span class="token" style="color:#bd93f9">0.864</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">40</span><span>x1            </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.0439</span><span>      </span><span class="token" style="color:#bd93f9">0.023</span><span>     </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">1.949</span><span>      </span><span class="token" style="color:#bd93f9">0.051</span><span>      </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.088</span><span>       </span><span class="token" style="color:#bd93f9">0.000</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">41</span><span>x2            </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.0390</span><span>      </span><span class="token" style="color:#bd93f9">0.035</span><span>     </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">1.109</span><span>      </span><span class="token" style="color:#bd93f9">0.267</span><span>      </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.108</span><span>       </span><span class="token" style="color:#bd93f9">0.030</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">42</span><span>x3            </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.3065</span><span>      </span><span class="token" style="color:#bd93f9">0.017</span><span>    </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">18.045</span><span>      </span><span class="token" style="color:#bd93f9">0.000</span><span>      </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.340</span><span>      </span><span class="token" style="color:#f8f8f2">-</span><span class="token" style="color:#bd93f9">0.273</span><span>
</span><span class="linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:3.25em;padding-right:1em;text-align:right;user-select:none;color:#6272a4">43</span><span></span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span><span class="token" style="color:#f8f8f2">==</span></code></pre><h2>Evaluating your Default Model</h2><ul><li>AUC and GINI</li></ul><h2>Common Mistakes and Pitfalls</h2><ul><li>Simpson&#x27;s Paradox</li></ul><h2>Other Important pieces</h2><ul><li>Panel Data and the Discrete-Time Hazard Model</li><li>Generating Adverse Actions codes has a variety of different approaches</li><li>Does a more complicated model impact my target population?</li></ul><h2>Conclusion</h2></div></article></main><footer class="text-lg font-light"><div style="padding-top:10px;padding-bottom:10px"><a class="text-lg font-bold" href="/">← Back home</a></div><hr/><div><p>Like this blog? Check out the code on my<!-- --> <a href="https://github.com/franciscojavierarceo/franciscojavierarceo.github.io">GitHub</a>.</p><p>Built with<!-- --> <a href="https://nextjs.org/">Next.js</a> and ☕</p></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"How to build a credit risk model","description":"A data scientists guide to building a basic credit risk model","date":"January 27, 2021"},"post":{"content":"\n\n*TL;DR: A Data Science Tutorial on building a Credit Risk model*\n\nI previously [wrote](/post/data-science-and-fintech) about some of the work data scientists do in the fintech space, which briefly discussed [credit risk models](https://en.wikipedia.org/wiki/Credit_risk) but I wanted to write a more technical review and talk about what I think are the most important points.\n\nI spent most of my career at banks as a data scientist and built credit risk models in the consumer and commercial space in the US, Australia, and South Africa. I learned a lot from those experiences, so I thought I'd share a simple example of how one of the core pieces of algorithmic/quantitative underwriting is done.\n\nIn this post, I'll try to answer the following questions:\n\n- What is a credit risk model?\n- What **data** does a credit risk model use?\n- How do you estimate a credit risk model?\n- How do you know if your model is performing well?\n- What are some common mistakes to avoid?\n- What are useful facts to know about credit risk models?\n\n## What is a Credit Risk Model?\n\nIn the consumer/retail space, a credit risk model tries to predict the probability that a consumer won't repay money that they've borrowed.\nA simple example of this is an [unsecured personal loan](https://www.investopedia.com/terms/u/unsecuredloan.asp). \nLet's suppose you submitted an application to borrow $5,000 from a lender. That lender would want to know the likelihood of [default](https://www.investopedia.com/terms/d/default2.asp) before deciding on (1) whether to give you the loan and (2) the price they want to charge you to for borrowing the money. So that probability is probably quite important...but how do they come up with it?\n\n## What Data does a Credit Risk model use?\n\nLenders typically use data from the major [Credit Bureaus](https://www.investopedia.com/personal-finance/top-three-credit-bureaus/) that is [FCRA](https://www.ftc.gov/enforcement/statutes/fair-credit-reporting-act) compliant, which basically means that the legal and reputational risk of using this data is very low.\n\nTypically, you'd purchase a dataset from one of the bureaus (or use data inside one of their analytical sandboxes) and clean the dataset into something that looks like the following:\n\n\u003ctable\u003e\n  \u003ctr\u003e\n    \u003cth\u003eDefault\u003c/th\u003e\n    \u003cth\u003eInquiries in Last 6 Months\u003c/th\u003e\n    \u003cth\u003eCredit Utilization\u003c/th\u003e\n    \u003cth\u003eAverage Age of Credit\u003c/th\u003e\n    \u003cth\u003e...\u003c/th\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003eYes\u003c/td\u003e\n    \u003ctd\u003e2\u003c/td\u003e\n    \u003ctd\u003e0.8\u003c/td\u003e\n    \u003ctd\u003e12\u003c/td\u003e\n    \u003ctd\u003e...\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003eNo\u003c/td\u003e\n    \u003ctd\u003e8\u003c/td\u003e\n    \u003ctd\u003e0.0\u003c/td\u003e\n    \u003ctd\u003e2\u003c/td\u003e\n    \u003ctd\u003e...\u003c/td\u003e\n  \u003c/tr\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e...\u003c/td\u003e\n    \u003ctd\u003e...\u003c/td\u003e\n    \u003ctd\u003e...\u003c/td\u003e\n    \u003ctd\u003e...\u003c/td\u003e\n    \u003ctd\u003e...\u003c/td\u003e\n  \u003c/tr\u003e\n\u003c/table\u003e\n\nAnd so on.\n\nIn summary, it's just a bunch of data about your borrowing history.\nIt's a little recursive/cyclical because in order to grow your credit you need to have credit but let's ignore that detail.\n\nOne of the most important steps in the model development process is *precisely* defining **default** because this will eventually reflect the performance of your portfolio, so defining it rigorously, accurately, and confidently is extremely consequential.\n\nSo how do you define it?\n\nTime. If you're planning to launch a term loan, you usually set boundaries on the duration of the loan.\nLet's say you want to launch a 12 month loan to an underserved market, then you'd want to get historical data of other lenders to build your model on.\nIt sounds a little surprising that you can do this but that's basically how the bureaus make their money.\nAn important thing to keep in mind is that you need to make sure you pull the data at 2 different time periods: (1) when the original application was made and (2) 12 months later to check if the consumer defaulted on their loan.\n\nThere's a lot more to it and you can expand on things in much more elegant ways to handle different phenomena but for the sake of simplicity, this is essentially how it's done.\n\nSo, after painfully cleaning up all that data, what do you do with it?\n\n## Building a Probability of Default Model\n\nNow that you have that glorious dataset you can start to run different [Logistic Regressions](https://en.wikipedia.org/wiki/Logistic_regression) or use other machine learning algorithms to find hidden patterns and relationships (i.e., [non-linear functions](https://blog.minitab.com/blog/adventures-in-statistics-2/what-is-the-difference-between-linear-and-nonlinear-equations-in-regression-analysis#:~:text=If%20the%20equation%20doesn't,a%20linear%20equation%2C%20it's%20nonlinear.\u0026text=Thetas%20represent%20the%20parameters%20and,one%20parameter%20per%20predictor%20variable.) and [interaction terms](https://en.wikipedia.org/wiki/Interaction_(statistics))).\nPersonally, this is the most intellectually engaging part of the work. The other work involved in credit risk modeling is usually very stressful and filled with less exciting graphs but here you get to pause, look at data, and, for a moment, try to make a crude approximation of the world. I find this part *fascinating*.\n\nIf we stick with our simple model above, we could use our good old friend Python to run a simple regression.\n\n```python\nimport numpy as np\nimport pandas as pd\nimport statsmodels.api as sm\n\nn = 10000\nnp.random.seed(0)\nx_1 = np.random.poisson(lam=5, size=n)\nx_2 = np.random.poisson(lam=2, size=n)\nx_3 = np.random.poisson(lam=12, size=n)\ne = np.random.normal(size=n, loc=0, scale=1.)\n\nb_1, b_2, b_3 = -0.005, -0.03, -0.15\nylogpred =  x_1 * b_1 + x_2 * b_2 + x_3 * b_3 + e\nyprob = 1./ (1.+ np.exp(-ylogpred))\nyclass = np.where(yprob \u003e= 0.5, 1, 0)\nxs = np.hstack([\n    x_1.reshape(n, 1), \n    x_2.reshape(n, 1), \n    x_3.reshape(n, 1)\n])\nxs = sm.add_constant(xs)\nmodel = sm.Logit(y, x)\nres = model.fit()\nprint(res.summary())\n         Current function value: 0.163863\n         Iterations 8\n                           Logit Regression Results                           \n==============================================================================\nDep. Variable:                      y   No. Observations:                10000\nModel:                          Logit   Df Residuals:                     9996\nMethod:                           MLE   Df Model:                            3\nDate:                Fri, 29 Jan 2021   Pseudo R-squ.:                  0.1056\nTime:                        00:08:17   Log-Likelihood:                -1638.6\nconverged:                       True   LL-Null:                       -1832.2\nCovariance Type:            nonrobust   LLR p-value:                 1.419e-83\n==============================================================================\n                 coef    std err          z      P\u003e|z|      [0.025      0.975]\n------------------------------------------------------------------------------\nconst          0.4535      0.209      2.166      0.030       0.043       0.864\nx1            -0.0439      0.023     -1.949      0.051      -0.088       0.000\nx2            -0.0390      0.035     -1.109      0.267      -0.108       0.030\nx3            -0.3065      0.017    -18.045      0.000      -0.340      -0.273\n==============================================================================\n```\n\n\n\n## Evaluating your Default Model\n- AUC and GINI\n\n## Common Mistakes and Pitfalls\n- Simpson's Paradox\n\n## Other Important pieces\n- Panel Data and the Discrete-Time Hazard Model\n- Generating Adverse Actions codes has a variety of different approaches\n- Does a more complicated model impact my target population?\n\n## Conclusion\n","excerpt":""},"previousPost":{"slug":"data-science-and-fintech","frontmatter":{"title":"Data Science and Fintech","description":"How Data Science Scaled the Fintech Revolution","date":"January 22, 2021"},"excerpt":"","content":"\nI've spent the last 10 years working in data science, mostly in finance and technology (fintech) and it's been really exciting to see how data science, engineering, and the internet has reshaped all aspects of finance.\n\n[Others have written before](https://fintechtoday.substack.com/p/part-1-what-is-fintech-30-anyway) about how fintech has evolved over the last decade and one area that I think is interesting is how data science and analytics has helped fuel that growth.\n\n\u003eSo, how ***exactly*** has data science helped scale fintech?\n\nI think data science has scaled fintech in five key areas.\n\n## 1. Operations\u003ca name=\"Operations\"\u003e\u003c/a\u003e\n\nThe market tends to have a preference for technology companies because of the operational efficiencies that come from technology's scale. Simply put, data scientists help identify data and processes that can be automated to help achieve better operational efficiency.\n\nA concrete fintech example of this is fraud operations. If you're a bank with a credit card product, manually reviewing even 10% of your credit card transactions would be an impossible, and costly, task (it's been [cited](https://www.marketwatch.com/story/why-bitcoin-wont-displace-visa-or-mastercard-soon-2017-12-15) that Visa and Mastercard process 5,000 transactions per second, which would mean that there are 5000 * 60 * 60 * 24=432,000,000 transactions per day to go through).\n\nSo, in this circumstance data scientists build technology and predictive models to reduce the amount of manual review.\n\n## 2. Marketing\u003ca name=\"Marketing\"\u003e\u003c/a\u003e\n\nIn fintech, Customer Acquisition Cost (CAC) is everything. Others have written about [CAC and fintech](https://medium.com/unifimoney/the-no-cac-bank-5e0e577d5473) in greater depth, but suffice it to say it is a challenging and competitive problem.\n\nData scientists focused on marketing try to reduce CAC through a wide variety of strategies.\nSome of them are by tightly monitoring product metrics to see which features yield the best ROI for growth, while other approaches take a broader lense by taking a comprehensive view of your marketing investments and, again, optimize the expected return (e.g., through [Marketing Mix Models](https://blog.hurree.co/blog/marketing-mix-modeling)).\n\nOther marketing focused approaches use [propensity models](https://medium.com/the-official-integrate-ai-blog/heres-what-you-need-to-know-about-propensity-modeling-521ab660cb43) to try to maximize customer engagement or acquisition. More concretely, this can involve building a propensity model to convert a customer from an email subscriber to a fully-converted user (e.g., for a lending product or a mobile application), while other propensities may focus on simply getting a customer to re-engage with your product.\n\n## 3. Risk Management\u003ca name=\"Risk-Management\"\u003e\u003c/a\u003e\n\nThis is where I've spent most of my career and I think it's a really hard problem that most fintechs struggle with in the lending space.\nGenerally speaking, data scientists will build risk models (e.g., for credit risk or fraud risk) to predict the probability of default or some likelihood of delinquency ([more on the difference between them](https://www.investopedia.com/ask/answers/062315/what-are-differences-between-delinquency-and-default.asp)).\n\nBuilding good predictive models is hard. Building good *risk* models is **extremely** hard.\n\nThis is less because of a technology or data problem and more because of regulatory checks and balances in place. Making sure that you adhere to [FCRA](https://www.ftc.gov/enforcement/statutes/fair-credit-reporting-act), [ECOA](https://uscode.house.gov/view.xhtml?req=granuleid%3AUSC-prelim-title15-chapter41-subchapter4\u0026edition=prelim), and other regulatory oversight is hard on its own, adding statistical analysis into the mix makes it more challenging.\n\nImplementation (i.e., getting an algorithm into production that impacts your customers) of these models is a whole other area of data science and one of the areas I personally find quite fun (maybe I'll write more about this topic later).\n\n## 4. Technology\u003ca name=\"Technology\"\u003e\u003c/a\u003e\n\nData scientists often work with engineering/technology teams in order to improve the technology stack. This may involve changing an architecture to reduce the latency of certain [microservices](https://microservices.io/) or enhancing the curent stack for a unique problem (cue machine learning and [Airflow DAGs](https://airflow.apache.org)).\nWhile some of this is behind the scenes, it can be some of the most impactful work done by a data scientist in the fintech space because of the broader impact to the core business.\n\n## 5. Product\u003ca name=\"Product\"\u003e\u003c/a\u003e\n\nData scientists working with product teams are often tasked with the measurement of different experiences within the product and finding out ways to enhance it. That can vary from creating dashboards to monitor the right metrics, to building a recommendation system to curate something specific for a user. \n\nData scientists can fuel product growth, which is why [Facebook, Google, Amazon, Microsoft](https://www.datasciencedegreeprograms.net/lists/five-of-the-largest-companies-that-employ-data-scientists/) and other tech companies hire so many data scientists.\n\nIt's worth noting that I've ignored many of the technology and organizational complexities involved when hiring or building data science teams but only because I wanted to keep this post high-level to introduce some of the applications of data science to fintech. In the future, I'll probably write more technical posts of each one of these to give more concrete examples with code and diagrams (which is what I find fun 😊). \n\nTo summarize, data scientists are useful (particularly in fintech) when there are hard problems and data available to solve them.\n\n*Have some feedback? Feel free to [let me know](https://twitter.com/franciscojarceo)!*"},"nextPost":null},"__N_SSG":true},"page":"/post/[slug]","query":{"slug":"how-to-build-a-credit-risk-model"},"buildId":"_yES9zDLT7Cb2-A5l1UOx","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-fa276ba060a4a8ac7eef.js"></script><script src="/_next/static/chunks/main-39418da170c6bb422e22.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.9707fddd9ae5927c17c3.js" async=""></script><script src="/_next/static/chunks/commons.a6f6c255f30e2cc8ab2c.js" async=""></script><script src="/_next/static/chunks/pages/_app-e96c85129056fdc0f68b.js" async=""></script><script src="/_next/static/chunks/5e7de4f36e438e169c5d145e7df90137ae956f1e.7d3641e730cc6fd301c7.js" async=""></script><script src="/_next/static/chunks/pages/post/%5Bslug%5D-30c90bc3b4b0bd4e7214.js" async=""></script><script src="/_next/static/_yES9zDLT7Cb2-A5l1UOx/_buildManifest.js" async=""></script><script src="/_next/static/_yES9zDLT7Cb2-A5l1UOx/_ssgManifest.js" async=""></script></body></html>